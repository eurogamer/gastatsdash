{% load humanize %}
<!DOCTYPE html>
<html>
	<head>
    	<meta charset="UTF-8">
	</head>
<body>
	<style>
	body, p{
		font-family: sans-serif;
		text-align: left;
		font-weight: normal;
	}
	thead th{
    	border-bottom: 1px solid #d0d9e0;
	}
	td, th {
		padding: 0.3em 1em 0.3em 0.5em;
		vertical-align: top;
	}
	th.src {
    	font-weight: lighter;
	}
	td.num {
    	text-align: right;
	}
	
	tr.odd {
    	background-color: #f0f2f4;
	}	
	
	tr.even {
    	
	}
    span  {
        display: list-item;
        list-style-type: none;
	}	
	img {
    	margin: 0.2em;
	}

	</style>
    <h2>
        Overview
    </h2>
    <table>
        <thead>
            <tr>
                <th></th>
                <th> Total Visitors </th>
                <th> Total Page Views </th>
                <th> Average Pages/Visitor </th>
                <th> Average Time Spent on Site </th>
            </tr>
        </thead>
        <tbody>
            <tr class="odd">
                <th> Current Data</th>
                <td> {{period_totals.first_period.visitors|intcomma|cut:".0"}} </td>
                <td> {{period_totals.first_period.pageviews|intcomma|cut:".0"}} </td>
                <td> {{period_totals.first_period.pv_per_session|floatformat}} </td>
                <td> {{period_totals.first_period.avg_time|floatformat}} minutes </td>
            </tr>
            <tr class="even">
                <th>{{ report_span|get_report_change }} Percentage Change </th>
                <td style="color: {% if period_totals.change.visitors > 0 %}green{% else %}red{% endif %};"> {{period_totals.change.visitors|as_percentage_of:period_totals.first_period.visitors}} </td>
                <td style="color: {% if period_totals.change.pageviews > 0 %}green{% else %}red{% endif %};"> {{period_totals.change.pageviews|as_percentage_of:period_totals.first_period.pageviews}}</td>
                <td style="color: {% if period_totals.change.pv_per_session > 0 %}green{% else %}red{% endif %};"> {{period_totals.change.pv_per_session|as_percentage_of:period_totals.first_period.pv_per_session}} </td>
                <td style="color: {% if period_totals.change.avg_time > 0 %}green{% else %}red{% endif %};"> {{period_totals.change.avg_time|as_percentage_of:period_totals.first_period.avg_time}} </td>
            </tr>  
            <tr class="odd">
                <th> YoY Percentage Change </th>
                <td style="color: {% if period_totals.yoy_change.visitors > 0 %}green{% else %}red{% endif %};"> {{period_totals.yoy_change.visitors|as_percentage_of:period_totals.first_period.visitors}} </td>
                <td style="color: {% if period_totals.yoy_change.pageviews > 0 %}green{% else %}red{% endif %};"> {{period_totals.yoy_change.pageviews|as_percentage_of:period_totals.first_period.pageviews}}</td>
                <td style="color: {% if period_totals.yoy_change.pv_per_session > 0 %}green{% else %}red{% endif %};"> {{period_totals.yoy_change.pv_per_session|as_percentage_of:period_totals.first_period.pv_per_session}} </td>
                <td style="color: {% if period_totals.yoy_change.avg_time > 0 %}green{% else %}red{% endif %};"> {{period_totals.yoy_change.avg_time|as_percentage_of:period_totals.first_period.avg_time}} </td>
            </tr>              
            {% if num_sites == 1 %}
                <tr class="even">
                    <th> Network Data </th>
                    <td> {{network_period_totals.first_period.visitors|intcomma|cut:".0"}} </td>
                    <td> {{network_period_totals.first_period.pageviews|intcomma|cut:".0"}} </td>
                    <td> {{network_period_totals.first_period.pv_per_session|floatformat}} </td>
                    <td> {{network_period_totals.first_period.avg_time|floatformat}} minutes </td>
                <tr> 
                <tr class="odd">
                    <th>{{ report_span|get_report_change }} Network Percentage Change </th>
                    <td style="color: {% if network_period_totals.change.visitors > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.change.visitors|as_percentage_of:network_period_totals.first_period.visitors}} </td>
                    <td style="color: {% if network_period_totals.change.pageviews > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.change.pageviews|as_percentage_of:network_period_totals.first_period.pageviews}}</td>
                    <td style="color: {% if network_period_totals.change.pv_per_session > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.change.pv_per_session|as_percentage_of:network_period_totals.first_period.pv_per_session}} </td>
                    <td style="color: {% if network_period_totals.change.avg_time > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.change.avg_time|as_percentage_of:network_period_totals.first_period.avg_time}} </td>
                </tr>   
                <tr class="even">
                    <th> YoY Network Percentage Change </th>
                    <td style="color: {% if network_period_totals.yoy_change.visitors > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.yoy_change.visitors|as_percentage_of:network_period_totals.first_period.visitors}} </td>
                    <td style="color: {% if network_period_totals.yoy_change.pageviews > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.yoy_change.pageviews|as_percentage_of:network_period_totals.first_period.pageviews}}</td>
                    <td style="color: {% if network_period_totals.yoy_change.pv_per_session > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.yoy_change.pv_per_session|as_percentage_of:network_period_totals.first_period.pv_per_session}} </td>
                    <td style="color: {% if network_period_totals.yoy_change.avg_time > 0 %}green{% else %}red{% endif %};"> {{network_period_totals.yoy_change.avg_time|as_percentage_of:network_period_totals.first_period.avg_time}} </td>
                </tr>                   
            {% endif %}                         
        </tbody>
    </table>
    {% if report_span == 'monthly' %}
    {% else %}
      <h2> 
        Traffic for this month so far
      </h2>
      <p>
        Accumulation of the data so far this month. From 01 to {{end_date}}.
      </p>
      <table>
          <thead>
              <tr>
                  <th></th>
                  <th> Total Visitors </th>
                  <th> Total Sessions </th>
                  <th> Total Page Views </th>
              </tr>
          </thead>
          <tbody>
              <tr class="odd">
                  <th> Data</th>
                  <td> {{monthly_totals.first_period.visitors|intcomma|cut:".0"}} </td>
                  <td> {{monthly_totals.first_period.sessions|intcomma|cut:".0"}} </td>
                  <td> {{monthly_totals.first_period.pageviews|intcomma|cut:".0"}} </td>
              </tr>
              <tr class="even">
                  <th> YoY Percentage Change </th>
                  <td style="color: {% if monthly_totals.change.visitors > 0 %}green{% else %}red{% endif %};"> {{monthly_totals.change.visitors|as_percentage_of:monthly_totals.first_period.visitors}} </td>
                  <td style="color: {% if monthly_totals.change.sessions > 0 %}green{% else %}red{% endif %};"> {{monthly_totals.change.sessions|as_percentage_of:monthly_totals.first_period.sessions}}</td>
                  <td style="color: {% if monthly_totals.change.pageviews > 0 %}green{% else %}red{% endif %};"> {{monthly_totals.change.pageviews|as_percentage_of:monthly_totals.first_period.pageviews}} </td>
  
              </tr>              
              {% if num_sites == 1 %}
                  <tr class="odd">
                      <th> Network Data </th>
                      <td> {{network_monthly_totals.first_period.visitors|intcomma|cut:".0"}} </td>
                      <td> {{network_monthly_totals.first_period.sessions|intcomma|cut:".0"}} </td>
                      <td> {{network_monthly_totals.first_period.pageviews|intcomma|cut:".0"}} </td>
                  </tr>  
                  <tr class="even">
                      <th> YoY Network Percentage Change </th>
                      <td style="color: {% if network_monthly_totals.change.visitors > 0 %}green{% else %}red{% endif %};"> {{network_monthly_totals.change.visitors|as_percentage_of:network_monthly_totals.first_period.visitors}} </td>
                      <td style="color: {% if network_monthly_totals.change.sessions > 0 %}green{% else %}red{% endif %};"> {{network_monthly_totals.change.sessions|as_percentage_of:network_monthly_totals.first_period.sessions}}</td>
                      <td style="color: {% if network_monthly_totals.change.pageviews > 0 %}green{% else %}red{% endif %};"> {{network_monthly_totals.change.pageviews|as_percentage_of:network_monthly_totals.first_period.pageviews}} </td>   
                  </tr>                 
                
              {% endif %}                       
          </tbody>
      </table>   
    {% endif %} 

</body>
